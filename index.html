<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–†–µ–∞–ª—å–Ω—ã–π –≠–∫–æ-–°–∫–∞–Ω–µ—Ä</title>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.16.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/mobilenet@2.1.0"></script>
  <style>
    body {
      text-align: center;
      font-family: Arial, sans-serif;
      background: #f0fdf4;
      padding: 20px;
    }
    video {
      max-width: 90%;
      border-radius: 12px;
      border: 3px solid #333;
    }
    button {
      margin-top: 15px;
      padding: 12px 20px;
      font-size: 16px;
      background-color: #00a86b;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    #result {
      margin-top: 20px;
      font-size: 18px;
      background: white;
      padding: 15px;
      border-radius: 10px;
      border: 1px solid #ccc;
      display: none;
    }
  </style>
</head>
<body>

  <h1>‚ôªÔ∏è –≠–∫–æ-–°–∫–∞–Ω–µ—Ä 2.0</h1>
  <p>–ù–∞–≤–µ–¥–∏ –∫–∞–º–µ—Ä—É –Ω–∞ –º—É—Å–æ—Ä –∏ –Ω–∞–∂–º–∏ "–°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å"</p>

  <video id="video" autoplay playsinline width="400" height="300"></video><br>
  <button onclick="classify()">üîç –°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å</button>
  <div id="result">–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏...</div>

  <script>
    const video = document.getElementById('video');
    const result = document.getElementById('result');
    let model;

    async function startCamera() {
      const stream = await navigator.mediaDevices.getUserMedia({
        video: { facingMode: { exact: "environment" } },
        audio: false
      });
      video.srcObject = stream;
    }

    async function loadModel() {
      model = await mobilenet.load();
      result.innerText = "‚úÖ –ú–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞. –ì–æ—Ç–æ–≤ –∫ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—é.";
    }

    async function classify() {
      const canvas = document.createElement('canvas');
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      const ctx = canvas.getContext('2d');
      ctx.drawImage(video, 0, 0);

      const predictions = await model.classify(canvas);

      result.style.display = "block";
      result.innerHTML = `<strong>üß† –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ:</strong><br>`;

      predictions.forEach(pred => {
        result.innerHTML += `‚úîÔ∏è ${pred.className} (${(pred.probability * 100).toFixed(2)}%)<br>`;
      });
    }

    startCamera();
    loadModel();
  </script>

</body>
</html>
